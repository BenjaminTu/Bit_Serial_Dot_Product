circuit MatrixVectorCore : @[:@2.0]
  module MAC : @[:@3.2]
    input clock : Clock @[:@4.4]
    input reset : UInt<1> @[:@5.4]
    input io_a : SInt<2> @[:@6.4]
    input io_b : SInt<2> @[:@6.4]
    input io_c : SInt<1> @[:@6.4]
    output io_y : SInt<5> @[:@6.4]
  
    reg rA : SInt<2>, clock with :
      reset => (UInt<1>("h0"), rA) @[Gemm.scala 18:19:@10.4]
    reg rB : SInt<2>, clock with :
      reset => (UInt<1>("h0"), rB) @[Gemm.scala 19:19:@12.4]
    reg rC : SInt<1>, clock with :
      reset => (UInt<1>("h0"), rC) @[Gemm.scala 20:19:@14.4]
    node _T_18 = mul(rA, rB) @[Gemm.scala 22:14:@16.4]
    node mult = _T_18 @[Gemm.scala 16:18:@8.4 Gemm.scala 22:8:@17.4]
    node _T_19 = add(rC, mult) @[Gemm.scala 23:13:@18.4]
    node add = _T_19 @[Gemm.scala 17:18:@9.4 Gemm.scala 23:7:@19.4]
    io_y <= add @[Gemm.scala 25:8:@20.4]
    rA <= io_a @[Gemm.scala 18:19:@11.4]
    rB <= io_b @[Gemm.scala 19:19:@13.4]
    rC <= io_c @[Gemm.scala 20:19:@15.4]

  module PipeAdder : @[:@41.2]
    input clock : Clock @[:@42.4]
    input reset : UInt<1> @[:@43.4]
    input io_a : SInt<5> @[:@44.4]
    input io_b : SInt<5> @[:@44.4]
    output io_y : SInt<6> @[:@44.4]
  
    reg rA : SInt<5>, clock with :
      reset => (UInt<1>("h0"), rA) @[Gemm.scala 37:19:@47.4]
    reg rB : SInt<5>, clock with :
      reset => (UInt<1>("h0"), rB) @[Gemm.scala 38:19:@49.4]
    node _T_14 = add(rA, rB) @[Gemm.scala 39:13:@51.4]
    node add = _T_14 @[Gemm.scala 36:17:@46.4 Gemm.scala 39:7:@52.4]
    io_y <= add @[Gemm.scala 40:8:@53.4]
    rA <= io_a @[Gemm.scala 37:19:@48.4]
    rB <= io_b @[Gemm.scala 38:19:@50.4]

  module DotProduct : @[:@55.2]
    input clock : Clock @[:@56.4]
    input reset : UInt<1> @[:@57.4]
    input io_a_0 : SInt<2> @[:@58.4]
    input io_a_1 : SInt<2> @[:@58.4]
    input io_b_0 : SInt<2> @[:@58.4]
    input io_b_1 : SInt<2> @[:@58.4]
    output io_y : SInt<6> @[:@58.4]
  
    inst m_0 of MAC @[Gemm.scala 57:32:@60.4]
    inst m_1 of MAC @[Gemm.scala 57:32:@63.4]
    inst a_0_0 of PipeAdder @[Gemm.scala 59:30:@66.4]
    io_y <= a_0_0.io_y @[Gemm.scala 84:8:@77.4]
    m_0.clock <= clock @[:@61.4]
    m_0.reset <= reset @[:@62.4]
    m_0.io_a <= io_a_0 @[Gemm.scala 64:15:@69.4]
    m_0.io_b <= io_b_0 @[Gemm.scala 65:15:@70.4]
    m_0.io_c <= asSInt(UInt<1>("h0")) @[Gemm.scala 66:15:@71.4]
    m_1.clock <= clock @[:@64.4]
    m_1.reset <= reset @[:@65.4]
    m_1.io_a <= io_a_1 @[Gemm.scala 64:15:@72.4]
    m_1.io_b <= io_b_1 @[Gemm.scala 65:15:@73.4]
    m_1.io_c <= asSInt(UInt<1>("h0")) @[Gemm.scala 66:15:@74.4]
    a_0_0.clock <= clock @[:@67.4]
    a_0_0.reset <= reset @[:@68.4]
    a_0_0.io_a <= m_0.io_y @[Gemm.scala 74:22:@75.4]
    a_0_0.io_b <= m_1.io_y @[Gemm.scala 75:22:@76.4]

  module Pipe : @[:@155.2]
    input clock : Clock @[:@156.4]
    input reset : UInt<1> @[:@157.4]
    input io_enq_valid : UInt<1> @[:@158.4]
    input io_enq_bits : UInt<32> @[:@158.4]
    output io_deq_valid : UInt<1> @[:@158.4]
    output io_deq_bits : UInt<32> @[:@158.4]
  
    reg _T_19 : UInt<1>, clock with :
      reset => (UInt<1>("h0"), _T_19) @[Valid.scala 48:22:@160.4]
    reg _T_21 : UInt<32>, clock with :
      reset => (UInt<1>("h0"), _T_21) @[Reg.scala 11:16:@162.4]
    node _GEN_0 = mux(io_enq_valid, io_enq_bits, _T_21) @[Reg.scala 12:19:@163.4]
    reg _T_24 : UInt<1>, clock with :
      reset => (UInt<1>("h0"), _T_24) @[Valid.scala 48:22:@166.4]
    reg _T_26 : UInt<32>, clock with :
      reset => (UInt<1>("h0"), _T_26) @[Reg.scala 11:16:@168.4]
    node _GEN_1 = mux(_T_19, _T_21, _T_26) @[Reg.scala 12:19:@169.4]
    reg _T_29 : UInt<1>, clock with :
      reset => (UInt<1>("h0"), _T_29) @[Valid.scala 48:22:@172.4]
    reg _T_31 : UInt<32>, clock with :
      reset => (UInt<1>("h0"), _T_31) @[Reg.scala 11:16:@174.4]
    node _GEN_2 = mux(_T_24, _T_26, _T_31) @[Reg.scala 12:19:@175.4]
    node _T_35_valid = _T_29 @[Valid.scala 43:21:@178.4 Valid.scala 44:17:@179.4]
    node _T_35_bits = _T_31 @[Valid.scala 43:21:@178.4 Valid.scala 45:16:@180.4]
    io_deq_valid <= _T_35_valid @[Valid.scala 70:10:@182.4]
    io_deq_bits <= _T_35_bits @[Valid.scala 70:10:@181.4]
    _T_19 <= mux(reset, UInt<1>("h0"), io_enq_valid) @[Valid.scala 48:22:@161.4]
    _T_21 <= _GEN_0 @[Reg.scala 12:23:@164.6]
    _T_24 <= mux(reset, UInt<1>("h0"), _T_19) @[Valid.scala 48:22:@167.4]
    _T_26 <= _GEN_1 @[Reg.scala 12:23:@170.6]
    _T_29 <= mux(reset, UInt<1>("h0"), _T_24) @[Valid.scala 48:22:@173.4]
    _T_31 <= _GEN_2 @[Reg.scala 12:23:@176.6]

  module MatrixVectorCore : @[:@213.2]
    input clock : Clock @[:@214.4]
    input reset : UInt<1> @[:@215.4]
    input io_reset : UInt<1> @[:@216.4]
    input io_inp_valid : UInt<1> @[:@216.4]
    input io_inp_bits_0_0 : UInt<2> @[:@216.4]
    input io_inp_bits_0_1 : UInt<2> @[:@216.4]
    input io_wgt_valid : UInt<1> @[:@216.4]
    input io_wgt_bits_0_0 : UInt<2> @[:@216.4]
    input io_wgt_bits_0_1 : UInt<2> @[:@216.4]
    input io_wgt_bits_1_0 : UInt<2> @[:@216.4]
    input io_wgt_bits_1_1 : UInt<2> @[:@216.4]
    input io_acc_i_valid : UInt<1> @[:@216.4]
    input io_acc_i_bits_0_0 : UInt<32> @[:@216.4]
    input io_acc_i_bits_0_1 : UInt<32> @[:@216.4]
    input io_shift_valid : UInt<1> @[:@216.4]
    input io_shift_bits : UInt<6> @[:@216.4]
    output io_acc_o_valid : UInt<1> @[:@216.4]
    output io_acc_o_bits_0_0 : UInt<32> @[:@216.4]
    output io_acc_o_bits_0_1 : UInt<32> @[:@216.4]
    output io_out_valid : UInt<1> @[:@216.4]
    output io_out_bits_0_0 : UInt<2> @[:@216.4]
    output io_out_bits_0_1 : UInt<2> @[:@216.4]
  
    inst dot_0 of DotProduct @[Gemm.scala 99:34:@218.4]
    inst dot_1 of DotProduct @[Gemm.scala 99:34:@221.4]
    inst acc_0 of Pipe @[Gemm.scala 100:34:@224.4]
    inst acc_1 of Pipe @[Gemm.scala 100:34:@227.4]
    reg shiftReg_0 : SInt<32>, clock with :
      reset => (UInt<1>("h0"), shiftReg_0) @[Gemm.scala 103:31:@236.4]
    reg shiftReg_1 : SInt<32>, clock with :
      reset => (UInt<1>("h0"), shiftReg_1) @[Gemm.scala 103:31:@236.4]
    node _T_662 = and(io_inp_valid, io_wgt_valid) @[Gemm.scala 106:41:@237.4]
    node _T_663 = and(_T_662, io_acc_i_valid) @[Gemm.scala 106:56:@238.4]
    node _T_664 = and(_T_663, io_shift_valid) @[Gemm.scala 106:73:@239.4]
    node _T_665 = not(io_reset) @[Gemm.scala 106:92:@240.4]
    node _T_666 = and(_T_664, _T_665) @[Gemm.scala 106:90:@241.4]
    node _T_667 = asSInt(io_inp_bits_0_0) @[Gemm.scala 109:43:@244.4]
    node _T_668 = asSInt(io_wgt_bits_0_0) @[Gemm.scala 110:43:@246.4]
    node _T_669 = asSInt(io_inp_bits_0_1) @[Gemm.scala 109:43:@248.4]
    node _T_670 = asSInt(io_wgt_bits_0_1) @[Gemm.scala 110:43:@250.4]
    node _T_671 = dshl(dot_0.io_y, io_shift_bits) @[Gemm.scala 112:44:@252.4]
    node _T_672 = asSInt(acc_0.io_deq_bits) @[Gemm.scala 113:34:@254.4]
    node _T_673 = add(_T_672, shiftReg_0) @[Gemm.scala 113:41:@255.4]
    node _T_674 = tail(_T_673, 1) @[Gemm.scala 113:41:@256.4]
    node _T_675 = asSInt(_T_674) @[Gemm.scala 113:41:@257.4]
    node add_0 = _T_675 @[Gemm.scala 101:32:@230.4 Gemm.scala 113:12:@258.4]
    node _T_677 = asUInt(add_0) @[Gemm.scala 114:54:@259.4]
    node _T_678 = mux(io_reset, UInt<1>("h0"), _T_677) @[Gemm.scala 114:31:@260.4]
    node _T_679 = asUInt(add_0) @[Gemm.scala 115:33:@262.4]
    node _T_680 = and(io_inp_valid, io_wgt_valid) @[Gemm.scala 106:41:@265.4]
    node _T_681 = and(_T_680, io_acc_i_valid) @[Gemm.scala 106:56:@266.4]
    node _T_682 = and(_T_681, io_shift_valid) @[Gemm.scala 106:73:@267.4]
    node _T_683 = not(io_reset) @[Gemm.scala 106:92:@268.4]
    node _T_684 = and(_T_682, _T_683) @[Gemm.scala 106:90:@269.4]
    node _T_685 = asSInt(io_inp_bits_0_0) @[Gemm.scala 109:43:@272.4]
    node _T_686 = asSInt(io_wgt_bits_1_0) @[Gemm.scala 110:43:@274.4]
    node _T_687 = asSInt(io_inp_bits_0_1) @[Gemm.scala 109:43:@276.4]
    node _T_688 = asSInt(io_wgt_bits_1_1) @[Gemm.scala 110:43:@278.4]
    node _T_689 = dshl(dot_1.io_y, io_shift_bits) @[Gemm.scala 112:44:@280.4]
    node _T_690 = asSInt(acc_1.io_deq_bits) @[Gemm.scala 113:34:@282.4]
    node _T_691 = add(_T_690, shiftReg_1) @[Gemm.scala 113:41:@283.4]
    node _T_692 = tail(_T_691, 1) @[Gemm.scala 113:41:@284.4]
    node _T_693 = asSInt(_T_692) @[Gemm.scala 113:41:@285.4]
    node add_1 = _T_693 @[Gemm.scala 101:32:@231.4 Gemm.scala 113:12:@286.4]
    node _T_695 = asUInt(add_1) @[Gemm.scala 114:54:@287.4]
    node _T_696 = mux(io_reset, UInt<1>("h0"), _T_695) @[Gemm.scala 114:31:@288.4]
    node _T_697 = asUInt(add_1) @[Gemm.scala 115:33:@290.4]
    node vld_1 = acc_1.io_deq_valid @[Gemm.scala 102:17:@232.4 Gemm.scala 116:12:@292.4]
    node vld_0 = acc_0.io_deq_valid @[Gemm.scala 102:17:@232.4 Gemm.scala 116:12:@264.4]
    node _T_698 = cat(vld_1, vld_0) @[Gemm.scala 118:25:@293.4]
    node _T_699 = not(_T_698) @[Gemm.scala 118:32:@294.4]
    node _T_701 = eq(_T_699, UInt<1>("h0")) @[Gemm.scala 118:32:@295.4]
    node _T_702 = or(_T_701, io_reset) @[Gemm.scala 118:37:@296.4]
    node _T_703 = cat(vld_1, vld_0) @[Gemm.scala 119:23:@298.4]
    node _T_704 = not(_T_703) @[Gemm.scala 119:30:@299.4]
    node _T_706 = eq(_T_704, UInt<1>("h0")) @[Gemm.scala 119:30:@300.4]
    node _T_639_0 = asSInt(UInt<32>("h0")) @[Gemm.scala 103:35:@233.4 Gemm.scala 103:35:@234.4]
    node _T_639_1 = asSInt(UInt<32>("h0")) @[Gemm.scala 103:35:@233.4 Gemm.scala 103:35:@235.4]
    io_acc_o_valid <= _T_702 @[Gemm.scala 118:18:@297.4]
    io_acc_o_bits_0_0 <= _T_678 @[Gemm.scala 114:25:@261.4]
    io_acc_o_bits_0_1 <= _T_696 @[Gemm.scala 114:25:@289.4]
    io_out_valid <= _T_706 @[Gemm.scala 119:16:@301.4]
    io_out_bits_0_0 <= bits(_T_679, 1, 0) @[Gemm.scala 115:23:@263.4]
    io_out_bits_0_1 <= bits(_T_697, 1, 0) @[Gemm.scala 115:23:@291.4]
    dot_0.clock <= clock @[:@219.4]
    dot_0.reset <= reset @[:@220.4]
    dot_0.io_a_0 <= _T_667 @[Gemm.scala 109:22:@245.4]
    dot_0.io_a_1 <= _T_669 @[Gemm.scala 109:22:@249.4]
    dot_0.io_b_0 <= _T_668 @[Gemm.scala 110:22:@247.4]
    dot_0.io_b_1 <= _T_670 @[Gemm.scala 110:22:@251.4]
    dot_1.clock <= clock @[:@222.4]
    dot_1.reset <= reset @[:@223.4]
    dot_1.io_a_0 <= _T_685 @[Gemm.scala 109:22:@273.4]
    dot_1.io_a_1 <= _T_687 @[Gemm.scala 109:22:@277.4]
    dot_1.io_b_0 <= _T_686 @[Gemm.scala 110:22:@275.4]
    dot_1.io_b_1 <= _T_688 @[Gemm.scala 110:22:@279.4]
    acc_0.clock <= clock @[:@225.4]
    acc_0.reset <= reset @[:@226.4]
    acc_0.io_enq_valid <= _T_666 @[Gemm.scala 106:25:@242.4]
    acc_0.io_enq_bits <= io_acc_i_bits_0_0 @[Gemm.scala 107:24:@243.4]
    acc_1.clock <= clock @[:@228.4]
    acc_1.reset <= reset @[:@229.4]
    acc_1.io_enq_valid <= _T_684 @[Gemm.scala 106:25:@270.4]
    acc_1.io_enq_bits <= io_acc_i_bits_0_1 @[Gemm.scala 107:24:@271.4]
    shiftReg_0 <= mux(reset, _T_639_0, asSInt(bits(_T_671, 31, 0))) @[Gemm.scala 112:29:@253.4]
    shiftReg_1 <= mux(reset, _T_639_1, asSInt(bits(_T_689, 31, 0))) @[Gemm.scala 112:29:@281.4]
